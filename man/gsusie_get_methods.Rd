% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gsusie_utils.R
\name{gsusie_get_objective}
\alias{gsusie_get_objective}
\alias{gsusie_get_cs}
\title{Inferences From Fitted G-SuSiE / SuSiE Model}
\usage{
gsusie_get_objective(res, last_only = TRUE, warning_tol = 1e-06)

gsusie_get_cs(
  res,
  X = NULL,
  Xcorr = NULL,
  coverage = 0.95,
  min_abs_corr = 0.5,
  dedup = TRUE,
  squared = FALSE,
  check_symmetric = TRUE,
  n_purity = 100,
  use_rfast
)
}
\arguments{
\item{X}{n by p matrix of values of p variables (covariates) in
n samples. When provided, correlation between variables will be
computed and used to remove CSs whose minimum correlation among
variables is smaller than \code{min_abs_corr}.}

\item{Xcorr}{p by p matrix of correlations between variables (covariates).
When provided, it will be used to remove CSs whose minimum correlation
among variables is smaller than \code{min_abs_corr}.}

\item{coverage}{A number between 0 and 1 specifying desired coverage
of each CS.}

\item{min_abs_corr}{A "purity" threshold for the CS. Any CS that contains
a pair of variables with correlation less than this threshold will be
filtered out and not reported.}

\item{dedup}{If \code{dedup = TRUE}, remove duplicate CSs.}

\item{squared}{If \code{squared = TRUE}, report min, mean and median of
squared correlation instead of the absolute correlation.}

\item{check_symmetric}{If \code{check_symmetric = TRUE}, perform a check
for symmetry of matrix \code{Xcorr} when \code{Xcorr} is provided
(not \code{NULL}).}

\item{n_purity}{The maximum number of credible set (CS) variables used in
calculating the correlation (\dQuote{purity}) statistic.
When the number of variables included in the CS is greater than
this number, the CS variables are randomly subsampled.}

\item{use_rfast}{Use the Rfast package for purity calculations.
By default \code{use_rfast = TRUE} if the Rfast package is installed.}
}
\value{
\code{gsusie_get_objective} returns the evidence lower bound
(ELBO) achieved by the fitted susie model and, optionally, at each
iteration of the IBSS fitting procedure.cs

\code{gsusie_get_prior_variance} returns the (estimated or fixed)
prior variance parameters.

\code{gsusie_get_posterior_mean} returns the posterior mean for the
regression coefficients of the fitted susie model.

\code{gsusie_get_posterior_sd} returns the posterior standard
deviation for coefficients of the fitted susie model.

\code{gsusie_get_niter} returns the number of model fitting
iterations performed.

\code{gsusie_get_pip} returns a vector containing the posterior
inclusion probabilities (PIPs) for all variables.

\code{gsusie_get_lfsr} returns a vector containing the average lfsr
across variables for each single-effect, weighted by the posterior
inclusion probability (alpha).

\code{gsusie_get_posterior_samples} returns a list containing the
effect sizes samples and causal status with two components: \code{b},
an \code{num_variables} x \code{num_samples} matrix of effect
sizes; \code{gamma}, an \code{num_variables} x \code{num_samples}
matrix of causal status random draws.

\code{gsusie_get_cs} returns credible sets (CSs) from a susie fit,
as well as summaries of correlation among the variables included in
each CS. If desired, one can filter out CSs that do not meet a
specified \dQuote{purity} threshold; to do this, either \code{X} or
\code{Xcorr} must be supplied. It returns a list with the following
elements:

\item{cs}{A list in which each list element is a vector containing
the indices of the variables in the CS.}

\item{coverage}{The nominal coverage specified for each CS.}

\item{purity}{If \code{X} or \code{Xcorr} iis provided), the
purity of each CS.}

\item{cs_index}{If \code{X} or \code{Xcorr} is provided) the index
(number between 1 and L) of each reported CS in the supplied susie
fit.}
}
\description{
These functions access basic properties or
draw inference from a fitted susie/gsusie model.
The codes and descriptions below are copied from
\link{https://github.com/stephenslab/susieR/blob/master/R/susie_utils.R}
}
