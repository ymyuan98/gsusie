<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These functions access basic properties or
draw inference from a fitted susie/gsusie model.
The codes and descriptions below are copied from
https://github.com/stephenslab/susieR/blob/master/R/susie_utils.R"><title>Inferences From Fitted G-SuSiE/SuSiE Model — gsusie_get_objective • gsusie</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Inferences From Fitted G-SuSiE/SuSiE Model — gsusie_get_objective"><meta property="og:description" content="These functions access basic properties or
draw inference from a fitted susie/gsusie model.
The codes and descriptions below are copied from
https://github.com/stephenslab/susieR/blob/master/R/susie_utils.R"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gsusie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ymyuan98/gsusie">Source</a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Inferences From Fitted G-SuSiE/SuSiE Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/ymyuan98/gsusie/blob/HEAD/R/gsusie_utils.R" class="external-link"><code>R/gsusie_utils.R</code></a></small>
      <div class="d-none name"><code>gsusie_get_methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions access basic properties or
draw inference from a fitted susie/gsusie model.
The codes and descriptions below are copied from
<a href="https://github.com/stephenslab/susieR/blob/master/R/susie_utils.R" class="external-link">https://github.com/stephenslab/susieR/blob/master/R/susie_utils.R</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gsusie_get_objective</span><span class="op">(</span><span class="va">res</span>, last_only <span class="op">=</span> <span class="cn">TRUE</span>, warning_tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsusie_get_log_pseudo_variance</span><span class="op">(</span><span class="va">res</span>, X <span class="op">=</span> <span class="cn">NULL</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsusie_get_posterior_mean</span><span class="op">(</span><span class="va">res</span>, prior_tol <span class="op">=</span> <span class="fl">1e-09</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsusie_get_posterior_sd</span><span class="op">(</span><span class="va">res</span>, prior_tol <span class="op">=</span> <span class="fl">1e-09</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsusie_get_niter</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsusie_get_prior_variance</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsusie_get_lfsr</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsusie_get_posterior_samples</span><span class="op">(</span><span class="va">res</span>, <span class="va">num_samples</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsusie_get_cs</span><span class="op">(</span></span>
<span>  <span class="va">res</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Xcorr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coverage <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  min_abs_corr <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  dedup <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  squared <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_symmetric <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_purity <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gsusie_get_pip</span><span class="op">(</span><span class="va">res</span>, prune_by_cs <span class="op">=</span> <span class="cn">FALSE</span>, prior_tol <span class="op">=</span> <span class="fl">1e-09</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>res</dt>
<dd><p>A susie fit, an output from <code>susie</code>
or <code><a href="gsusie.html">gsusie</a></code>.</p></dd>


<dt>last_only</dt>
<dd><p>If <code>last_only = FALSE</code>, return the ELBO from
all iterations; otherwise return the ELBO from the last iteration
only.</p></dd>


<dt>warning_tol</dt>
<dd><p>Warn if ELBO is decreasing by this
tolerance level.</p></dd>


<dt>X</dt>
<dd><p>n by p matrix of values of p variables (covariates) in
n samples. When provided, correlation between variables will be
computed and used to remove CSs whose minimum correlation among
variables is smaller than <code>min_abs_corr</code>.</p></dd>


<dt>scale</dt>
<dd><p>Boolean,
indicates whether input <code>X</code> needs to be scaled or not.</p></dd>


<dt>prior_tol</dt>
<dd><p>Filter out effects having estimated prior variance
smaller than this threshold.</p></dd>


<dt>num_samples</dt>
<dd><p>The number of draws from the posterior
distribution.</p></dd>


<dt>Xcorr</dt>
<dd><p>p by p matrix of correlations between variables (covariates).
When provided, it will be used to remove CSs whose minimum correlation
among variables is smaller than <code>min_abs_corr</code>.</p></dd>


<dt>coverage</dt>
<dd><p>A number between 0 and 1 specifying desired coverage
of each CS.</p></dd>


<dt>min_abs_corr</dt>
<dd><p>A "purity" threshold for the CS. Any CS that contains
a pair of variables with correlation less than this threshold will be
filtered out and not reported.</p></dd>


<dt>dedup</dt>
<dd><p>If <code>dedup = TRUE</code>, remove duplicate CSs.</p></dd>


<dt>squared</dt>
<dd><p>If <code>squared = TRUE</code>, report min, mean and median of
squared correlation instead of the absolute correlation.</p></dd>


<dt>check_symmetric</dt>
<dd><p>If <code>check_symmetric = TRUE</code>, perform a check
for symmetry of matrix <code>Xcorr</code> when <code>Xcorr</code> is provided
(not <code>NULL</code>).</p></dd>


<dt>n_purity</dt>
<dd><p>The maximum number of credible set (CS) variables used in
calculating the correlation (“purity”) statistic.
When the number of variables included in the CS is greater than
this number, the CS variables are randomly subsampled.</p></dd>


<dt>prune_by_cs</dt>
<dd><p>Whether or not to ignore single effects not in
a reported CS when calculating PIP.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>gsusie_get_objective</code> returns the evidence lower bound
(ELBO) achieved by the fitted susie model and, optionally, at each
iteration of the IBSS fitting procedure.cs</p>


<p><code>gsusie_get_prior_variance</code> returns the (estimated or fixed)
prior variance parameters.</p>


<p><code>gsusie_get_posterior_mean</code> returns the posterior mean for the
regression coefficients of the fitted susie model.</p>


<p><code>gsusie_get_posterior_sd</code> returns the posterior standard
deviation for coefficients of the fitted susie model.</p>


<p><code>gsusie_get_niter</code> returns the number of model fitting
iterations performed.</p>


<p><code>gsusie_get_pip</code> returns a vector containing the posterior
inclusion probabilities (PIPs) for all variables.</p>


<p><code>gsusie_get_lfsr</code> returns a vector containing the average lfsr
across variables for each single-effect, weighted by the posterior
inclusion probability (alpha).</p>


<p><code>gsusie_get_posterior_samples</code> returns a list containing the
effect sizes samples and causal status with two components: <code>b</code>,
an <code>num_variables</code> x <code>num_samples</code> matrix of effect
sizes; <code>gamma</code>, an <code>num_variables</code> x <code>num_samples</code></p>


<p>matrix of causal status random draws.</p>


<p><code>gsusie_get_cs</code> returns credible sets (CSs) from a susie fit,
as well as summaries of correlation among the variables included in
each CS. If desired, one can filter out CSs that do not meet a
specified “purity” threshold; to do this, either <code>X</code> or
<code>Xcorr</code> must be supplied. It returns a list with the following
elements:</p>
<dl><dt>cs</dt>
<dd><p>A list in which each list element is a vector containing
the indices of the variables in the CS.</p></dd>


<dt>coverage</dt>
<dd><p>The nominal coverage specified for each CS.</p></dd>


<dt>purity</dt>
<dd><p>If <code>X</code> or <code>Xcorr</code> iis provided), the
purity of each CS.</p></dd>


<dt>cs_index</dt>
<dd><p>If <code>X</code> or <code>Xcorr</code> is provided) the index
(number between 1 and L) of each reported CS in the supplied susie
fit.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ming Yuan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

