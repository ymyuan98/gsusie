<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gsusie">
<title>Quick Demo 2: Modelling count-type responses via Poisson regression based GSuSiE model • gsusie</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quick Demo 2: Modelling count-type responses via Poisson regression based GSuSiE model">
<meta property="og:description" content="gsusie">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gsusie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ymyuan98/gsusie">Source</a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Quick Demo 2: Modelling count-type responses via Poisson regression based GSuSiE model</h1>
                        <h4 data-toc-skip class="author">Ming Yuan</h4>
            
            <h4 data-toc-skip class="date">2024-02-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ymyuan98/gsusie/blob/HEAD/vignettes/gsusie-poisson.Rmd" class="external-link"><code>vignettes/gsusie-poisson.Rmd</code></a></small>
      <div class="d-none name"><code>gsusie-poisson.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we show how to apply the <code><a href="../reference/gsusie.html">gsusie()</a></code>
function on a Poisson regression based GSuSiE model dedicated to
handling count-type responses.</p>
<div class="section level2">
<h2 id="get-genotype-data-and-generate-count-type-responses">Get genotype data and generate count-type responses<a class="anchor" aria-label="anchor" href="#get-genotype-data-and-generate-count-type-responses"></a>
</h2>
<p>We simulate response using genotype data from an R package named <a href="https://github.com/privefl/bigsnpr/" class="external-link">bigsnpr</a>. The explanatory
variables <code>X</code> in this example, saved in
<code>./data/genotype/genotype-subset-2.rds</code>, is a subset of
genotype data containing 2000 successive SNPs of 500 individuals. The
data are extracted using the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("bigsnpr")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://privefl.github.io/bigsnpr/" class="external-link">bigsnpr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">`%&amp;%`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span></span>
<span><span class="va">data.dir</span> <span class="op">&lt;-</span> <span class="st">"../data/genotype"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">data.dir</span>, recursive<span class="op">=</span><span class="cn">TRUE</span>, showWarnings<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">.bed.file</span> <span class="op">&lt;-</span> <span class="va">data.dir</span> <span class="op">%&amp;%</span> <span class="st">"1000G_phase3_common_norel.bed"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">.bed.file</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">bigsnpr</span><span class="fu">::</span><span class="fu"><a href="https://privefl.github.io/bigsnpr/reference/download_1000G.html" class="external-link">download_1000G</a></span><span class="op">(</span><span class="va">data.dir</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">.bk.file</span> <span class="op">&lt;-</span> <span class="va">data.dir</span> <span class="op">%&amp;%</span> <span class="st">"1000G_phase3_common_norel.rds"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">.bk.file</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">BED</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://privefl.github.io/bigsnpr/reference/snp_readBed.html" class="external-link">snp_readBed</a></span><span class="op">(</span><span class="va">.bed.file</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://privefl.github.io/bigsnpr/reference/snp_attach.html" class="external-link">snp_attach</a></span><span class="op">(</span><span class="va">.bk.file</span><span class="op">)</span><span class="op">$</span><span class="va">genotypes</span></span>
<span></span>
<span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456789</span><span class="op">)</span></span>
<span><span class="va">startpoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">:</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">-</span><span class="va">pp</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">nn</span> <span class="op">&lt;</span> <span class="fl">2490</span><span class="op">)</span> <span class="op">{</span><span class="va">ii.idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">:</span> <span class="fl">2490</span>, size <span class="op">=</span> <span class="va">nn</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">ii.idx</span>, <span class="va">startpoint</span> <span class="op">:</span> <span class="op">(</span><span class="va">startpoint</span><span class="op">+</span><span class="va">pp</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">example.data.dir</span> <span class="op">&lt;-</span> <span class="st">"./example-data/"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">X</span>, file <span class="op">=</span> <span class="va">example.data.dir</span> <span class="op">%&amp;%</span> <span class="st">"genotype-subset-2.rds"</span><span class="op">)</span></span></code></pre></div>
<p>Three effect variables are randomly selected, each having a non-zero
effect size of 1 (before scaling). Then, we generate the linear
predictor <code>eta</code>. We scale the linear combination to avoid
unexpected large or small values in <code>eta</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">`%&amp;%`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span></span>
<span><span class="va">example.data.dir</span> <span class="op">&lt;-</span> <span class="st">"./example-data/"</span></span>
<span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">example.data.dir</span> <span class="op">%&amp;%</span> <span class="st">"genotype-subset-2.rds"</span><span class="op">)</span></span>
<span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>  <span class="co"># 500</span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>  <span class="co"># 2000</span></span>
<span></span>
<span><span class="va">n_effect_vars</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## independent variables with non-zero effects</span></span>
<span><span class="va">effect_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">pp</span>, size <span class="op">=</span> <span class="va">n_effect_vars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">effect_idx</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 142  51 720</span></span>
<span></span>
<span><span class="co">## effect size</span></span>
<span><span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, times <span class="op">=</span> <span class="va">n_effect_vars</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## linear predictor</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="va">effect_idx</span>, drop<span class="op">=</span><span class="cn">F</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">effect_size</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## response</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">nn</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The histogram of the synthetic response is:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">y</span>, breaks <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="gsusie-poisson_files/figure-html/unnamed-chunk-3-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
</div>
<div class="section level2">
<h2 id="fit-a-poisson-regression-based-gsusie-model">Fit a Poisson regression based GSuSiE model<a class="anchor" aria-label="anchor" href="#fit-a-poisson-regression-based-gsusie-model"></a>
</h2>
<p>When fitting a GLM-based GSuSiE model, we prefer adding an all-one
column to introduce an intercept term. In practice, we are inclined to
add this auxiliary column to the end of the design matrix X such that
variable indices would not be confusing when printing the summarized
results by the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function. This step is optional;
nevertheless, we find that, by adding this all-one column, the model is
less likely to be overfitted. (Wooh!)</p>
<p>By default, we assume there are no more than 10 effect variables and
set <code>maxL = min(10, ncol(X))</code>. You may choose to specify
another value to <code>maxL</code>.</p>
<p>To specify fitting a <strong>Poisson regression based GSuSiE
model</strong>, use the argument <code>family = "poisson"</code>.
Correspondingly, the <code><a href="../reference/gsusie.html">gsusie()</a></code> function call is:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ymyuan98/gsusie" class="external-link">gsusie</a></span><span class="op">)</span></span>
<span><span class="va">res_gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsusie.html">gsusie</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="check-the-variable-selection-results">Check the variable selection results<a class="anchor" aria-label="anchor" href="#check-the-variable-selection-results"></a>
</h2>
<div class="section level3">
<h3 id="posterior-inclusion-probabilities">Posterior inclusion probabilities<a class="anchor" aria-label="anchor" href="#posterior-inclusion-probabilities"></a>
</h3>
<p>The <code><a href="../reference/print_gsusie_coefficients.html">print_gsusie_coefficients()</a></code> function offers 10 (by
default) variables with the highest posterior inclusion probabilities
(PIPs). By default, we output 95% credible intervals for the posterior
means of each variable.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/print_gsusie_coefficients.html">print_gsusie_coefficients</a></span><span class="op">(</span><span class="va">res_gs</span><span class="op">)</span></span>
<span><span class="co">#&gt;  variable    PIP PostMean PostSD CI_lower CI_upper</span></span>
<span><span class="co">#&gt;       720 1.0000   1.2171 0.0454   1.1281   1.3060</span></span>
<span><span class="co">#&gt;      1321 1.0000   0.2156 0.0798   0.0591   0.3720</span></span>
<span><span class="co">#&gt;       142 1.0000   1.0311 0.0296   0.9731   1.0890</span></span>
<span><span class="co">#&gt;       134 1.0000   0.0153 0.0619  -0.1060   0.1366</span></span>
<span><span class="co">#&gt;        51 1.0000   1.1500 0.0394   1.0727   1.2273</span></span>
<span><span class="co">#&gt;       148 0.0025   0.0013 0.0246  -0.0469   0.0496</span></span>
<span><span class="co">#&gt;       143 0.0003   0.0001 0.0083  -0.0161   0.0163</span></span>
<span><span class="co">#&gt;        54 0.0000   0.0000 0.0047  -0.0092   0.0092</span></span>
<span><span class="co">#&gt;       141 0.0000   0.0000 0.0000   0.0000   0.0000</span></span>
<span><span class="co">#&gt;       150 0.0000   0.0000 0.0000   0.0000   0.0000</span></span></code></pre></div>
<p>True effect variables (<code>X51</code>, <code>X142</code>, and
<code>X720</code>) are detected with high PIPs. However, null variables
<code>X1321</code> and <code>X134</code> are also detected, and their
corresponding PIPs are also close to 1. Well, the result is not that
satisfying, as two out of five detected variables are not effect
variables.</p>
</div>
<div class="section level3">
<h3 id="credible-sets-cs">Credible sets (CS)<a class="anchor" aria-label="anchor" href="#credible-sets-cs"></a>
</h3>
<p>As with the SuSiE method, we output 95% credible sets by default.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_gs</span><span class="op">$</span><span class="va">sets</span><span class="op">)</span></span>
<span><span class="co">#&gt; $cs</span></span>
<span><span class="co">#&gt; $cs$L1</span></span>
<span><span class="co">#&gt; [1] 1321</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cs$L2</span></span>
<span><span class="co">#&gt; [1] 51</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cs$L3</span></span>
<span><span class="co">#&gt; [1] 134</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cs$L4</span></span>
<span><span class="co">#&gt; [1] 720</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cs$L6</span></span>
<span><span class="co">#&gt; [1] 142</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $purity</span></span>
<span><span class="co">#&gt;    min.abs.corr mean.abs.corr mean.abs.corr</span></span>
<span><span class="co">#&gt; L1            1             1             1</span></span>
<span><span class="co">#&gt; L2            1             1             1</span></span>
<span><span class="co">#&gt; L3            1             1             1</span></span>
<span><span class="co">#&gt; L4            1             1             1</span></span>
<span><span class="co">#&gt; L6            1             1             1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cs_index</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coverage</span></span>
<span><span class="co">#&gt; [1] 1.0000000 0.9999780 0.9998448 1.0000000 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $requested_coverage</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span></code></pre></div>
<p>Each credible set contain one single variable, and two of them
contains null variables <code>X1321</code> and <code>X134</code>.</p>
</div>
<div class="section level3">
<h3 id="graphical-display">Graphical Display<a class="anchor" aria-label="anchor" href="#graphical-display"></a>
</h3>
<p>The <code><a href="../reference/gsusie_plots.html">gsusie_plot()</a></code> function provides plots for PIP of
each variable.</p>
<p>By default, since the intercept is just an auxiliary variable, we do
not include it in the plot. In this case, argument
<code>intercept_index</code> needs to be specified. (P.S. By default, we
set <code>include_intercept = FALSE</code> to remove the intercept term
on the plot.)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gsusie_plots.html">gsusie_plot</a></span><span class="op">(</span><span class="va">res_gs</span>, y <span class="op">=</span> <span class="st">"PIP"</span>, </span>
<span>            include_intercept <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            intercept_index <span class="op">=</span> <span class="op">(</span><span class="va">pp</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>            effect_indices <span class="op">=</span> <span class="va">effect_idx</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="gsusie-poisson_files/figure-html/unnamed-chunk-7-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
<p>By specifying <code>effect_indices</code>, the true effect variables
are colored in red. The 95% credible sets are identified as circled in
different colors.</p>
<p>The plot also vividly presents that the null variables
<code>X1321</code> and `X134 are mistakenly selected because of their
high PIPs. Therefore, we hope to address these false discoveries.</p>
</div>
</div>
<div class="section level2">
<h2 id="refine-a-poisson-regression-based-gsusie-model-via-robust-estimation">Refine a Poisson regression based GSuSiE model via robust
estimation<a class="anchor" aria-label="anchor" href="#refine-a-poisson-regression-based-gsusie-model-via-robust-estimation"></a>
</h2>
<p>As we know, count data (in the response) usually contains extremely
large values. These unexpected values may affect the model fitting,
resulting in false discoveries or even failure to fit the model.</p>
<p>Hence, we suggest robust estimation when modelling a Poisson
regression based GSuSiE model. Our <code>gsusie</code> function provides
several robust estimation approaches. Based on our experience in
simulation experiments, we recommend the <strong>Huber reweighting
method</strong>, which, in each iteration, reweights each data point by
Huber weight<span class="citation">(Huber 1964)</span> according to its
residual updated from the previous iteration <span style="color: gray;">(by M-estimation)</span>.</p>
<p>The corresponding function call is:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_gs_hb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsusie.html">gsusie</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, </span>
<span>                    robust_estimation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    robust_method <span class="op">=</span> <span class="st">"huber"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="check-the-refined-variable-selection-results">Check the refined variable selection results<a class="anchor" aria-label="anchor" href="#check-the-refined-variable-selection-results"></a>
</h3>
<p>The fitted results as well as graphical display are:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/print_gsusie_coefficients.html">print_gsusie_coefficients</a></span><span class="op">(</span><span class="va">res_gs_hb</span><span class="op">)</span></span>
<span><span class="co">#&gt;  variable    PIP PostMean PostSD CI_lower CI_upper</span></span>
<span><span class="co">#&gt;       720 1.0000   1.2238 0.0451   1.1354   1.3123</span></span>
<span><span class="co">#&gt;       142 1.0000   1.0320 0.0298   0.9737   1.0904</span></span>
<span><span class="co">#&gt;        51 1.0000   0.8946 0.1623   0.5765   1.2128</span></span>
<span><span class="co">#&gt;        54 0.7108  -0.3032 0.1672  -0.6309   0.0244</span></span>
<span><span class="co">#&gt;        55 0.0000   0.0000 0.0000   0.0000   0.0000</span></span>
<span><span class="co">#&gt;        53 0.0000   0.0000 0.0000   0.0000   0.0000</span></span>
<span><span class="co">#&gt;      2001 0.0000   0.0000 0.0000   0.0000   0.0000</span></span>
<span><span class="co">#&gt;       150 0.0000   0.0000 0.0000   0.0000   0.0000</span></span>
<span><span class="co">#&gt;       123 0.0000   0.0000 0.0000   0.0000   0.0000</span></span>
<span><span class="co">#&gt;       152 0.0000   0.0000 0.0000   0.0000   0.0000</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_gs_hb</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variables in credible sets:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  variable variable_prob cs</span></span>
<span><span class="co">#&gt;       720     1.0000000  4</span></span>
<span><span class="co">#&gt;       142     1.0000000  2</span></span>
<span><span class="co">#&gt;        51     0.9999941  3</span></span>
<span><span class="co">#&gt;        54     0.7107968  3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Credible sets summary:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  cs cs_loge_abf cs_avg_r2 cs_min_r2 variable</span></span>
<span><span class="co">#&gt;   1   131.74824 1.0000000 1.0000000       51</span></span>
<span><span class="co">#&gt;   2   286.25426 1.0000000 1.0000000      142</span></span>
<span><span class="co">#&gt;   4    58.45426 1.0000000 1.0000000      720</span></span>
<span><span class="co">#&gt;   3    30.45770 0.8725642 0.8725642    51,54</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res_gs_hb</span><span class="op">$</span><span class="va">sets</span><span class="op">)</span></span>
<span><span class="co">#&gt; $cs</span></span>
<span><span class="co">#&gt; $cs$L1</span></span>
<span><span class="co">#&gt; [1] 51</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cs$L2</span></span>
<span><span class="co">#&gt; [1] 142</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cs$L4</span></span>
<span><span class="co">#&gt; [1] 720</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cs$L3</span></span>
<span><span class="co">#&gt; [1] 51 54</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $purity</span></span>
<span><span class="co">#&gt;    min.abs.corr mean.abs.corr mean.abs.corr</span></span>
<span><span class="co">#&gt; L1    1.0000000     1.0000000     1.0000000</span></span>
<span><span class="co">#&gt; L2    1.0000000     1.0000000     1.0000000</span></span>
<span><span class="co">#&gt; L4    1.0000000     1.0000000     1.0000000</span></span>
<span><span class="co">#&gt; L3    0.9341115     0.9341115     0.9341115</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cs_index</span></span>
<span><span class="co">#&gt; [1] 1 2 4 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coverage</span></span>
<span><span class="co">#&gt; [1] 0.9999917 1.0000000 1.0000000 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $requested_coverage</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gsusie_plots.html">gsusie_plot</a></span><span class="op">(</span><span class="va">res_gs_hb</span>, y <span class="op">=</span> <span class="st">"PIP"</span>, </span>
<span>            include_intercept <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            intercept_index <span class="op">=</span> <span class="op">(</span><span class="va">pp</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>            effect_indices <span class="op">=</span> <span class="va">effect_idx</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="gsusie-poisson_files/figure-html/unnamed-chunk-12-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
<p>From above, we notice that, by applying the robust Huber reweighting
method, the selection accuracy is somehow improved: the PIPs of
<code>X1321</code> and <code>X134</code> no longer deviate from 0 and
thus are not able to be falsely discovered. Instead, the null variable
<code>X54</code> is detected along with the true effect variable
<code>X51</code>, but the PIP of the former is relatively lower than
that of the latter. Besides, as suggested above, <code>X51</code> is
captured by two different credible sets, one of which contains only
<code>X51</code>. This may indicate that <code>X51</code> is likely to
be more important than <code>X54</code>.</p>
<p>Well, to me, the refined results are at least more gratifying than
the unrefined ones.</p>
<p>Other than performing Huber reweighting via M-estimation procedures,
we also provide an option of Huber reweighting via S-estimation<span class="citation">(Rousseeuw and Yohai 1984)</span>. The corresponding
function call is:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_gs_hb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsusie.html">gsusie</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, </span>
<span>                     robust_estimation <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     robust_method <span class="op">=</span> <span class="st">"huber"</span>, </span>
<span>                     robust_tuning_method <span class="op">=</span> <span class="st">"S"</span><span class="op">)</span></span></code></pre></div>
<p>The fitted results as well as graphical display are:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/print_gsusie_coefficients.html">print_gsusie_coefficients</a></span><span class="op">(</span><span class="va">res_gs_hb2</span><span class="op">)</span></span>
<span><span class="co">#&gt;  variable    PIP PostMean PostSD CI_lower CI_upper</span></span>
<span><span class="co">#&gt;       720 1.0000   1.2209 0.0639   1.0955   1.3462</span></span>
<span><span class="co">#&gt;       142 1.0000   1.0400 0.0420   0.9577   1.1223</span></span>
<span><span class="co">#&gt;        51 0.9662   0.9021 0.2870   0.3396   1.4646</span></span>
<span><span class="co">#&gt;        54 0.4280  -0.2771 0.2880  -0.8415   0.2873</span></span>
<span><span class="co">#&gt;       150 0.0000   0.0000 0.0008  -0.0015   0.0015</span></span>
<span><span class="co">#&gt;      2001 0.0000   0.0000 0.0000  -0.0001   0.0001</span></span>
<span><span class="co">#&gt;        53 0.0000   0.0000 0.0000   0.0000   0.0000</span></span>
<span><span class="co">#&gt;        55 0.0000   0.0000 0.0000   0.0000   0.0000</span></span>
<span><span class="co">#&gt;      1511 0.0000   0.0000 0.0000   0.0000   0.0000</span></span>
<span><span class="co">#&gt;       440 0.0000   0.0000 0.0000   0.0000   0.0000</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_gs_hb2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variables in credible sets:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  variable variable_prob cs</span></span>
<span><span class="co">#&gt;       720     1.0000000  4</span></span>
<span><span class="co">#&gt;       142     0.9999989  2</span></span>
<span><span class="co">#&gt;        51     0.9662311  1</span></span>
<span><span class="co">#&gt;        54     0.4279796  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Credible sets summary:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  cs cs_loge_abf cs_avg_r2 cs_min_r2 variable</span></span>
<span><span class="co">#&gt;   2   141.07966 1.0000000 1.0000000      142</span></span>
<span><span class="co">#&gt;   4    24.27865 1.0000000 1.0000000      720</span></span>
<span><span class="co">#&gt;   1    30.77141 0.8725642 0.8725642    51,54</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gsusie_plots.html">gsusie_plot</a></span><span class="op">(</span><span class="va">res_gs_hb2</span>, y <span class="op">=</span> <span class="st">"PIP"</span>, </span>
<span>            include_intercept <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            intercept_index <span class="op">=</span> <span class="op">(</span><span class="va">pp</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>            effect_indices <span class="op">=</span> <span class="va">effect_idx</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="gsusie-poisson_files/figure-html/unnamed-chunk-16-1.png" alt="&amp;nbsp;" width="600"><p class="caption">
 
</p>
</div>
<p>In simulation experiments, results yielded from Huber reweighting via
both M- and S-estimation procedures are alike.</p>
<blockquote>
<p>Our previous experience suggests that the Bisquare reweighting method
is usually too conservative to offer as much informative information as
the Huber reweighting method. We do not recommend simply removing a
proportion of data points whose pseudo-weights or pseudo-residuals
exceed a certain threshold, as it is difficult to tell whether this
specific threshold is appropriate or not.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="suggestions-for-preprocessing-count-type-responses">Suggestions for preprocessing count-type responses<a class="anchor" aria-label="anchor" href="#suggestions-for-preprocessing-count-type-responses"></a>
</h2>
<p>Two cases in the count data response that may result in difficulty
fitting a Poisson regression based GSuSiE model. One is the presence of
too many zeros, and the other is the existence of some unexpectedly
large values. The former can be addressed by fitting a zero-inflated
Poisson or a negative binomial regression model; however, the GSuSiE
versions of these two genearlized linear models have not yet been
developed in our <code>gsusie</code> package. The latter may lead to
unexpected failure of fitting a GSuSiE model, as those extreme values
may lead to overflow in certain fitting procedure.</p>
<p>A simple approach to simultaneously address both problems is to
preprocess the response: we scale the response without changing the
shape of its original distribution. Specifically, the following
transformation is operated</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log1p</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>and then the new <span class="math inline">\(y\)</span> is plugged
into the <code>gsusie</code> function to fit a GSuSiE model. This
transformation on <span class="math inline">\(y\)</span> is particularly
beneficial in reducing the chance of failure in model fitting.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-huber1964" class="csl-entry">
Huber, Peter J. 1964. <span>“Robust Estimation of a Location
Parameter.”</span> <em>The Annals of Mathematical Statistics</em> 35
(1): 73–101. <a href="https://doi.org/10.1214/aoms/1177703732" class="external-link">https://doi.org/10.1214/aoms/1177703732</a>.
</div>
<div id="ref-rousseeuw1984" class="csl-entry">
Rousseeuw, P., and V. Yohai. 1984. <span>“Robust Regression by Means of
S-Estimators.”</span> In, edited by Jürgen Franke, Wolfgang Härdle, and
Douglas Martin, 256–72. Lecture Notes in Statistics. New York, NY:
Springer US. <a href="https://doi.org/10.1007/978-1-4615-7821-5_15" class="external-link">https://doi.org/10.1007/978-1-4615-7821-5_15</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ming Yuan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
